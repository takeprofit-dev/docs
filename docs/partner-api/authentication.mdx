---
title: Authentication
description: The Authentication API allows partners to authenticate and obtain access tokens required for accessing other secured endpoints. This documentation provides details on how to use the authentication endpoints, including request and response formats, and includes OpenAPI definitions.
---

## Overview

The Authentication API provides two primary endpoints:

1. **Login**: Authenticates a partner using their API key and returns an access token and a refresh token.
2. **Refresh**: Generates a new access token using a valid refresh token.

## Base URL

```plaintext
https://api.dev.tpinf.in
```

## Endpoints

- [Login](#login)
- [Refresh](#refresh)

---

## Login

Authenticates a partner using their API key.

### HTTP Request

`POST /takeprofit.partner.external.auth.v1.AuthApi.Login`

### Request Body

```json
{
	"api_key": "YOUR_API_KEY_HERE"
}
```

- **api_key** (`string`, required): Your unique API key provided by TakeProfit.

### Response

**Success (HTTP 200):**

```json
{
	"status": {
		"code": 0,
		"message": "",
		"details": []
	},
	"access_token": {
		"token": "ACCESS_TOKEN",
		"valid_to_time": "2024-10-30T12:57:25Z"
	},
	"refresh_token": {
		"token": "REFRESH_TOKEN",
		"valid_to_time": "2024-10-30T14:27:25Z"
	}
}
```

**Fields:**

- **status**:
  - **code** (`integer`): Status code (`0` indicates success).
  - **message** (`string`): Status message.
  - **details** (`array`): Additional details.
- **access_token**:
  - **token** (`string`): JWT access token.
  - **valid_to_time** (`string`): Expiration time of the access token in ISO 8601 format.
- **refresh_token**:
  - **token** (`string`): JWT refresh token.
  - **valid_to_time** (`string`): Expiration time of the refresh token in ISO 8601 format.

**Error (HTTP 400 or 401):**

```json
{
	"status": {
		"code": 7,
		"message": "Invalid api_key",
		"details": []
	}
}
```

### Example Request

```bash
curl --location 'https://api.dev.tpinf.in/takeprofit.partner.external.auth.v1.AuthApi.Login' \
--header 'Content-Type: application/json' \
--data '{
    "api_key": "YOUR_API_KEY_HERE"
}'
```

### Example Response

<Tabs>
<TabItem value="success" label="Success">

```json
{
	"status": {
		"code": 0,
		"message": "",
		"details": []
	},
	"access_token": {
		"token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
		"valid_to_time": "2024-10-30T12:57:25Z"
	},
	"refresh_token": {
		"token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
		"valid_to_time": "2024-10-30T14:27:25Z"
	}
}
```

</TabItem>
<TabItem value="error" label="Error">

```json
{
	"status": {
		"code": 7,
		"message": "Invalid api_key",
		"details": []
	}
}
```

</TabItem>
</Tabs>

---

## Refresh

Generates a new access token using a valid refresh token.

### HTTP Request

`POST /takeprofit.partner.external.auth.v1.AuthApi.Refresh`

### Request Body

```json
{
	"refresh_token": "YOUR_REFRESH_TOKEN_HERE"
}
```

- **refresh_token** (`string`, required): A valid refresh token obtained from the Login endpoint.

### Response

**Success (HTTP 200):**

```json
{
	"status": {
		"code": 0,
		"message": "",
		"details": []
	},
	"access_token": {
		"token": "NEW_ACCESS_TOKEN",
		"valid_to_time": "2024-10-30T13:57:25Z"
	}
}
```

**Fields:**

- **status**:
  - **code** (`integer`): Status code (`0` indicates success).
  - **message** (`string`): Status message.
  - **details** (`array`): Additional details.
- **access_token**:
  - **token** (`string`): New JWT access token.
  - **valid_to_time** (`string`): Expiration time of the new access token in ISO 8601 format.

**Error (HTTP 400 or 401):**

```json
{
	"status": {
		"code": 16,
		"message": "Invalid refresh_token",
		"details": []
	}
}
```

### Example Request

```bash
curl --location 'https://api.dev.tpinf.in/takeprofit.partner.external.auth.v1.AuthApi.Refresh' \
--header 'Content-Type: application/json' \
--data '{
    "refresh_token": "YOUR_REFRESH_TOKEN_HERE"
}'
```

### Example Response

<Tabs>
<TabItem value="success" label="Success">

```json
{
	"status": {
		"code": 0,
		"message": "",
		"details": []
	},
	"access_token": {
		"token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
		"valid_to_time": "2024-10-30T13:57:25Z"
	}
}
```

</TabItem>
<TabItem value="error" label="Error">

```json
{
	"status": {
		"code": 16,
		"message": "Invalid refresh_token",
		"details": []
	}
}
```

</TabItem>
</Tabs>

---

## Authentication Workflow

1. **Login**:

   - Send a `POST` request to the Login endpoint with your `api_key`.
   - Receive an `access_token` and a `refresh_token`.

2. **Access Protected Resources**:

   - Use the `access_token` in the `Authorization` header for subsequent API requests.
   - Example: `Authorization: Bearer ACCESS_TOKEN`

3. **Token Refresh**:

   - Before the `access_token` expires, use the `refresh_token` to obtain a new `access_token`.
   - Send a `POST` request to the Refresh endpoint with your `refresh_token`.

4. **Handle Expiration**:
   - Monitor the `valid_to_time` to know when tokens expire.
   - If both tokens expire, you must log in again using the Login endpoint.

---

## OpenAPI Specification

```yaml
openapi: 3.0.0
info:
  title: Authentication API
  version: 1.0.0
servers:
  - url: https://api.dev.tpinf.in
paths:
  /takeprofit.partner.external.auth.v1.AuthApi.Login:
    post:
      summary: Login and obtain access and refresh tokens.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Successful authentication.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginResponse"
        "401":
          description: Invalid API key.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /takeprofit.partner.external.auth.v1.AuthApi.Refresh:
    post:
      summary: Refresh access token using a refresh token.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshRequest"
      responses:
        "200":
          description: Successful token refresh.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefreshResponse"
        "401":
          description: Invalid refresh token.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
components:
  schemas:
    LoginRequest:
      type: object
      properties:
        api_key:
          type: string
      required:
        - api_key
    LoginResponse:
      type: object
      properties:
        status:
          $ref: "#/components/schemas/Status"
        access_token:
          $ref: "#/components/schemas/JwtToken"
        refresh_token:
          $ref: "#/components/schemas/JwtToken"
    RefreshRequest:
      type: object
      properties:
        refresh_token:
          type: string
      required:
        - refresh_token
    RefreshResponse:
      type: object
      properties:
        status:
          $ref: "#/components/schemas/Status"
        access_token:
          $ref: "#/components/schemas/JwtToken"
    JwtToken:
      type: object
      properties:
        token:
          type: string
        valid_to_time:
          type: string
          format: date-time
    Status:
      type: object
      properties:
        code:
          type: integer
        message:
          type: string
        details:
          type: array
          items:
            type: string
    ErrorResponse:
      type: object
      properties:
        status:
          $ref: "#/components/schemas/Status"
```

---

## Best Practices

- **Secure Storage**: Store your `api_key`, `access_token`, and `refresh_token` securely. Do not expose them in client-side code or version control systems.
- **Token Expiration Handling**: Implement logic to refresh your `access_token` before it expires using the `refresh_token`.
- **Error Handling**: Always check the `status.code` and handle errors appropriately.
- **HTTPS**: Ensure all requests are made over HTTPS to secure data in transit.
- **Rate Limiting**: Be mindful of rate limits and implement retry logic with exponential backoff as necessary.

---

## FAQ

### What should I do if my `api_key` is invalid?

Ensure that you are using the correct `api_key` provided to you. If the issue persists, contact support for assistance.

### How do I use the `access_token`?

Include the `access_token` in the `Authorization` header of your requests to other secured endpoints:

```http
Authorization: Bearer ACCESS_TOKEN
```

### What happens when my tokens expire?

- The `access_token` has a shorter lifespan and should be refreshed using the `refresh_token` before it expires.
- If the `refresh_token` expires, you must authenticate again using the Login endpoint.

### Is there a sandbox environment for testing?

Yes, use the base URL `https://api.dev.tpinf.in` for testing purposes. For production access, use the production base URL provided to you.

---

## Contact Support

If you encounter any issues or have questions, please contact our support team at [support@takeprofit.com](mailto:support@takeprofit.com).

---

**Note:** Replace `YOUR_API_KEY_HERE`, `ACCESS_TOKEN`, `REFRESH_TOKEN`, and other placeholders with your actual credentials when making requests.

---

# Additional Resources

- [Mintlify Documentation](https://mintlify.com/docs)
- [JWT Introduction](https://jwt.io/introduction)
- [ISO 8601 Date Format](https://en.wikipedia.org/wiki/ISO_8601)
